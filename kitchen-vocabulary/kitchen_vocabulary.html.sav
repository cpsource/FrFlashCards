<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vocabulaire de la Cuisine</title>
    <!-- Bootstrap v4 CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <style>
        body {
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        .container {
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            max-width: 800px;
        }
        h1 {
            color: #764ba2;
            text-align: center;
            margin-bottom: 30px;
            font-size: 2.5em;
        }
        .image-container {
            text-align: center;
            margin: 30px 0;
            min-height: 300px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
        }
        .main-image {
            width: 45%;
            max-width: 300px;
            height: auto;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        .placeholder-image {
            width: 300px;
            height: 300px;
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.5em;
            font-weight: bold;
            text-align: center;
            padding: 20px;
        }
        .button-container {
            text-align: center;
            margin: 30px 0;
        }
        .answer-text {
            text-align: center;
            margin-top: 20px;
            font-size: 2em;
            font-weight: bold;
            color: #764ba2;
            display: none;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 10px;
        }
        .next-button-container {
            text-align: center;
            margin-top: 30px;
            display: none;
        }
        .btn {
            margin: 5px;
            min-width: 150px;
        }
        .progress-info {
            text-align: center;
            margin-top: 20px;
            color: #666;
            font-size: 1.1em;
        }
        .easy-count {
            color: #28a745;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Nommez cette Image</h1>
        
        <div class="image-container">
            <div id="imageDisplay" class="placeholder-image">
                Loading...
            </div>
        </div>
        
        <div class="button-container">
            <button id="answerBtn" class="btn btn-primary btn-lg">Cliquez pour la Réponse</button>
        </div>
        
        <div id="answerText" class="answer-text">
            <!-- French name will appear here -->
        </div>
        
        <div id="nextButtonContainer" class="next-button-container">
            <button id="repeatBtn" class="btn btn-warning btn-lg">Répéter</button>
            <button id="easyBtn" class="btn btn-info btn-lg">Facile</button>
            <button id="nextBtn" class="btn btn-success btn-lg">Image Suivante</button>
        </div>
        
        <div class="progress-info">
            <p>Item: <span id="currentItem">1</span> / <span id="totalItems">0</span> 
            | Marqués comme facile: <span id="easyCount" class="easy-count">0</span></p>
        </div>
        
        <audio id="audioPlayer" style="display: none;">
            <source id="audioSource" src="" type="audio/mpeg">
            Votre navigateur ne supporte pas l'élément audio.
        </audio>
    </div>

    <!-- jQuery and Bootstrap JS -->
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.2/dist/js/bootstrap.bundle.min.js"></script>
    
    <script>
        // CSV data embedded (parsed from french_kitchen_vocabulary.csv)
        const vocabularyData = [
            {english: "spoon", french: "la cuillère", gender: "feminine"},
            {english: "fork", french: "la fourchette", gender: "feminine"},
            {english: "knife", french: "le couteau", gender: "masculine"},
            {english: "plate", french: "l'assiette", gender: "feminine"},
            {english: "bowl", french: "le bol", gender: "masculine"},
            {english: "glass", french: "le verre", gender: "masculine"},
            {english: "cup", french: "la tasse", gender: "feminine"},
            {english: "napkin", french: "la serviette", gender: "feminine"},
            {english: "straw", french: "la paille", gender: "feminine"},
            {english: "pot", french: "la marmite", gender: "feminine"},
            {english: "pan", french: "la poêle", gender: "feminine"},
            {english: "spatula", french: "la spatule", gender: "feminine"},
            {english: "whisk", french: "le fouet", gender: "masculine"},
            {english: "ladle", french: "la louche", gender: "feminine"},
            {english: "cutting board", french: "la planche à découper", gender: "feminine"},
            {english: "can opener", french: "l'ouvre-boîte", gender: "masculine"},
            {english: "grater", french: "la râpe", gender: "feminine"},
            {english: "colander", french: "la passoire", gender: "feminine"},
            {english: "mixing bowl", french: "le saladier", gender: "masculine"},
            {english: "pitcher", french: "la carafe", gender: "feminine"},
            {english: "teapot", french: "la théière", gender: "feminine"},
            {english: "coffee maker", french: "la cafetière", gender: "feminine"},
            {english: "toaster", french: "le grille-pain", gender: "masculine"},
            {english: "microwave", french: "le micro-ondes", gender: "masculine"},
            {english: "refrigerator", french: "le réfrigérateur", gender: "masculine"},
            {english: "oven", french: "le four", gender: "masculine"},
            {english: "stove", french: "la cuisinière", gender: "feminine"},
            {english: "dishwasher", french: "le lave-vaisselle", gender: "masculine"},
            {english: "sink", french: "l'évier", gender: "masculine"},
            {english: "faucet", french: "le robinet", gender: "masculine"},
            {english: "tablecloth", french: "la nappe", gender: "feminine"},
            {english: "placemat", french: "le set de table", gender: "masculine"},
            {english: "salt shaker", french: "la salière", gender: "feminine"},
            {english: "pepper mill", french: "le moulin à poivre", gender: "masculine"},
            {english: "bottle opener", french: "le décapsuleur", gender: "masculine"},
            {english: "corkscrew", french: "le tire-bouchon", gender: "masculine"},
            {english: "tray", french: "le plateau", gender: "masculine"},
            {english: "kettle", french: "la bouilloire", gender: "feminine"},
            {english: "saucepan", french: "la casserole", gender: "feminine"},
            {english: "lid", french: "le couvercle", gender: "masculine"},
            {english: "strainer", french: "la passoire", gender: "feminine"},
            {english: "peeler", french: "l'éplucheur", gender: "masculine"},
            {english: "rolling pin", french: "le rouleau à pâtisserie", gender: "masculine"},
            {english: "measuring cup", french: "le verre doseur", gender: "masculine"},
            {english: "timer", french: "le minuteur", gender: "masculine"},
            {english: "apron", french: "le tablier", gender: "masculine"},
            {english: "oven mitt", french: "le gant de cuisine", gender: "masculine"},
            {english: "dish rack", french: "l'égouttoir", gender: "masculine"},
            {english: "paper towel", french: "l'essuie-tout", gender: "masculine"}
        ];
        
        // State variables
        let currentIdx = 0;
        let activeItems = [...Array(vocabularyData.length).keys()]; // Array of indices [0, 1, 2, ...]
        let easyItems = new Set(); // Set of indices marked as easy
        
        // Load state from localStorage
        function loadState() {
            const savedEasy = localStorage.getItem('kitchenVocabEasy');
            if (savedEasy) {
                easyItems = new Set(JSON.parse(savedEasy));
                activeItems = activeItems.filter(idx => !easyItems.has(idx));
            }
            const savedIdx = localStorage.getItem('kitchenVocabIdx');
            if (savedIdx !== null) {
                currentIdx = parseInt(savedIdx);
                // Make sure currentIdx is valid
                if (currentIdx >= activeItems.length) {
                    currentIdx = 0;
                }
            }
        }
        
        // Save state to localStorage
        function saveState() {
            localStorage.setItem('kitchenVocabEasy', JSON.stringify([...easyItems]));
            localStorage.setItem('kitchenVocabIdx', currentIdx);
        }
        
        // Display current item
        function displayItem() {
            if (activeItems.length === 0) {
                alert('Félicitations! Vous avez marqué tous les items comme facile!');
                // Reset everything
                easyItems.clear();
                activeItems = [...Array(vocabularyData.length).keys()];
                currentIdx = 0;
                saveState();
            }
            
            const itemIdx = activeItems[currentIdx];
            const item = vocabularyData[itemIdx];
            
            // Update image or placeholder
            const imageDisplay = document.getElementById('imageDisplay');
            const imagePath = item.english.replace(/ /g, '-') + '.png';
            
            // Try to display image, fallback to text
            const img = new Image();
            img.onload = function() {
                imageDisplay.innerHTML = '';
                imageDisplay.className = '';
                img.className = 'main-image';
                imageDisplay.appendChild(img);
            };
            img.onerror = function() {
                // Image not found, show placeholder
                imageDisplay.className = 'placeholder-image';
                imageDisplay.innerHTML = item.english.toUpperCase() + '<br><small>(Image non disponible)</small>';
            };
            img.src = imagePath;
            
            // Update audio source
            const audioSource = document.getElementById('audioSource');
            audioSource.src = item.english.replace(/ /g, '-') + '.mp3';
            
            // Update answer text
            document.getElementById('answerText').textContent = item.french;
            
            // Update progress info
            document.getElementById('currentItem').textContent = currentIdx + 1;
            document.getElementById('totalItems').textContent = activeItems.length;
            document.getElementById('easyCount').textContent = easyItems.size;
            
            // Reset UI state
            resetUI();
        }
        
        // Reset UI to initial state
        function resetUI() {
            document.getElementById('answerText').style.display = 'none';
            document.getElementById('nextButtonContainer').style.display = 'none';
            const answerBtn = document.getElementById('answerBtn');
            answerBtn.disabled = false;
            answerBtn.textContent = 'Cliquez pour la Réponse';
            
            // Reset easy button
            const easyBtn = document.getElementById('easyBtn');
            easyBtn.classList.remove('btn-secondary');
            easyBtn.classList.add('btn-info');
            easyBtn.textContent = 'Facile';
            easyBtn.disabled = false;
        }
        
        // Initialize on page load
        document.addEventListener('DOMContentLoaded', function() {
            loadState();
            displayItem();
            
            // Answer button
            document.getElementById('answerBtn').addEventListener('click', function() {
                // Show answer
                document.getElementById('answerText').style.display = 'block';
                
                // Play audio
                const audio = document.getElementById('audioPlayer');
                audio.load(); // Reload audio with new source
                audio.play().catch(err => console.log('Audio play failed:', err));
                
                // Show next buttons
                document.getElementById('nextButtonContainer').style.display = 'block';
                
                // Disable answer button
                this.disabled = true;
                this.textContent = 'Réponse Révélée';
            });
            
            // Repeat button
            document.getElementById('repeatBtn').addEventListener('click', function() {
                resetUI();
            });
            
            // Easy button
            document.getElementById('easyBtn').addEventListener('click', function() {
                const itemIdx = activeItems[currentIdx];
                easyItems.add(itemIdx);
                activeItems = activeItems.filter(idx => idx !== itemIdx);
                
                // Adjust currentIdx if needed
                if (currentIdx >= activeItems.length && activeItems.length > 0) {
                    currentIdx = 0;
                }
                
                // Update button appearance
                this.classList.remove('btn-info');
                this.classList.add('btn-secondary');
                this.textContent = 'Marqué comme Facile ✓';
                this.disabled = true;
                
                saveState();
            });
            
            // Next button
            document.getElementById('nextBtn').addEventListener('click', function() {
                currentIdx++;
                if (currentIdx >= activeItems.length) {
                    currentIdx = 0;
                }
                saveState();
                displayItem();
            });
        });
        
        // Add keyboard shortcuts
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Enter' || e.key === ' ') {
                const answerBtn = document.getElementById('answerBtn');
                if (!answerBtn.disabled) {
                    answerBtn.click();
                } else {
                    document.getElementById('nextBtn').click();
                }
            } else if (e.key === 'r' || e.key === 'R') {
                document.getElementById('repeatBtn').click();
            } else if (e.key === 'f' || e.key === 'F') {
                const easyBtn = document.getElementById('easyBtn');
                if (!easyBtn.disabled) {
                    easyBtn.click();
                }
            }
        });
    </script>
</body>
</html>